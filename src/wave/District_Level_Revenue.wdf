["{}","{\"nodes\":{\"FORMULA6\":{\"sources\":[\"FORMULA5\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"((SUM_cy_gross_revenue_less_unsalables+SUM_next_day_pending)/\\\"Objectives.SUM_CY_Objectives\\\")*100\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value4\",\"scale\":2,\"label\":\"Value 4\",\"type\":\"NUMBER\"}]}},\"FORMULA13\":{\"sources\":[\"FORMULA11\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(Value5)\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"Value5_formula\",\"label\":\"Value 5 Formula\",\"type\":\"TEXT\"}]}},\"FORMULA7\":{\"sources\":[\"FORMULA6\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"current_date()\",\"defaultValue\":\"\",\"name\":\"CurrentDay\",\"format\":\"MM/dd/yyyy\",\"label\":\"Current Day\",\"type\":\"DATE_ONLY\"}]}},\"FORMULA8\":{\"sources\":[\"LOAD_DATASET2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"to_date(Date)\",\"defaultValue\":\"\",\"name\":\"Date_formula\",\"format\":\"MM/dd/yyyy\",\"label\":\"Date Formula\",\"type\":\"DATE_ONLY\"}]}},\"FORMULA9\":{\"sources\":[\"JOIN1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"\\\"DayFactor.Day_Factor\\\"\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value5\",\"scale\":2,\"label\":\"Value 5\",\"type\":\"NUMBER\"}]}},\"DROP_FIELDS0\":{\"sources\":[\"FORMULA13\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"SELECT\",\"ignoreMissingFields\":true,\"fields\":[\"District.Id\",\"KPIGroup\",\"KPITitle\",\"KPIDate\",\"Value1\",\"Value2\",\"Value3\",\"Value4_formula\",\"Value6\",\"ExternalID\",\"Value5_formula\"]},\"fields\":[]}},\"FORMULA10\":{\"sources\":[\"FORMULA9\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"\\\"DayFactor.WorkDaycou.Number_of_Working_Days\\\"\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value6\",\"scale\":0,\"label\":\"Value 6\",\"type\":\"NUMBER\"}]}},\"FORMULA11\":{\"sources\":[\"FORMULA10\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat('US01','_',KPIGroup,'_',KPITitle,'_',district)\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"ExternalID\",\"label\":\"External ID\",\"type\":\"TEXT\"}]}},\"FORMULA12\":{\"sources\":[\"FORMULA7\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"string(Value4)\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"Value4_formula\",\"label\":\"Value 4 Formula\",\"type\":\"TEXT\"}]}},\"OUTPUT0\":{\"sources\":[\"DROP_FIELDS0\"],\"action\":\"outputExternal\",\"parameters\":{\"hyperFileName\":\"\",\"connectorType\":\"SALESFORCE_OUTPUT\",\"externalIdFieldName\":\"MDLZ_ExternalId__c\",\"connectionName\":\"Mondelez\",\"fieldsMapping\":[{\"sourceField\":\"District.Id\",\"targetField\":\"MDLZ_TerritoryId__c\"},{\"sourceField\":\"KPIGroup\",\"targetField\":\"MDLZ_KPIGroup__c\"},{\"sourceField\":\"KPITitle\",\"targetField\":\"MDLZ_KPITitle__c\"},{\"sourceField\":\"KPIDate\",\"targetField\":\"MDLZ_KPIDate__c\"},{\"sourceField\":\"Value1\",\"targetField\":\"MDLZ_Value1__c\"},{\"sourceField\":\"Value2\",\"targetField\":\"MDLZ_Value2__c\"},{\"sourceField\":\"Value3\",\"targetField\":\"MDLZ_Value3__c\"},{\"sourceField\":\"Value4_formula\",\"targetField\":\"MDLZ_Value4__c\"},{\"sourceField\":\"Value6\",\"targetField\":\"MDLZ_Value6__c\"},{\"sourceField\":\"ExternalID\",\"targetField\":\"MDLZ_ExternalId__c\"},{\"sourceField\":\"Value5_formula\",\"targetField\":\"MDLZ_Value5__c\"}],\"operation\":\"upsert\",\"object\":\"MDLZ_KPIData__c\"}},\"LOAD_DATASET2\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Month_Day_1\",\"Date\",\"WorkDaycou.Number_of_Working_Days\",\"Day_Factor\",\"Day_Sum\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"Day_Factor\",\"label\":\"Day Factor\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET1\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"team\",\"sales_repterritory\",\"district\",\"PY_Objectives\",\"objectives\",\"CY_Objectives\",\"mtd\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"MDLZ_Territory_Objectives\",\"label\":\"MDLZ Territory Objectives\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"cy_calendar_day\",\"district\",\"team\",\"sales_repterritory\",\"District.Id\",\"cy_gross_revenue_less_unsalables\",\"py_gross_revenue_less_unsalables\",\"next_day_pending\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"MDLZ_Segment_Revenue\",\"label\":\"MDLZ Segment Revenue\",\"type\":\"analyticsDataset\"}}},\"FORMULA0\":{\"sources\":[\"JOIN0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'District'\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"KPIGroup\",\"label\":\"KPI Group\",\"type\":\"TEXT\"}]}},\"FORMULA1\":{\"sources\":[\"FORMULA0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"'Revenue'\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"KPITitle\",\"label\":\"KPI Title\",\"type\":\"TEXT\"}]}},\"FORMULA2\":{\"sources\":[\"FORMULA1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"now()\",\"defaultValue\":\"\",\"name\":\"KPIDate\",\"format\":\"yyyy-MM-dd HH:mm:ss\",\"label\":\"KPI Refresh Date\",\"type\":\"DATETIME\"}]}},\"FORMULA3\":{\"sources\":[\"FORMULA2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"0\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value1\",\"scale\":0,\"label\":\"Value 1\",\"type\":\"NUMBER\"}]}},\"FORMULA4\":{\"sources\":[\"FORMULA3\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"\\\"Objectives.SUM_CY_Objectives\\\"\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value2\",\"scale\":2,\"label\":\"Value 2\",\"type\":\"NUMBER\"}]}},\"FORMULA5\":{\"sources\":[\"FORMULA4\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_cy_gross_revenue_less_unsalables + SUM_next_day_pending\",\"defaultValue\":\"\",\"precision\":18,\"name\":\"Value3\",\"scale\":2,\"label\":\"Value 3\",\"type\":\"NUMBER\"}]}},\"FILTER0\":{\"sources\":[\"LOAD_DATASET0\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":0,\"type\":\"N_MONTHS\"},{\"argument\":0,\"type\":\"N_MONTHS\"}],\"field\":\"cy_calendar_day\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"FILTER1\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":0,\"type\":\"N_MONTHS\"},{\"argument\":0,\"type\":\"N_MONTHS\"}],\"field\":\"mtd\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"AGGREGATE3\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_cy_gross_revenue_less_unsalables\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_py_gross_revenue_less_unsalables\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_next_day_pending\"}]},\"sources\":[\"EXTRACT1\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"district\",\"District.Id\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_cy_gross_revenue_less_unsalables\",\"action\":\"SUM\",\"source\":\"cy_gross_revenue_less_unsalables\",\"label\":\"Sum of CY Gross Revenue less Unsalables\"},{\"name\":\"SUM_py_gross_revenue_less_unsalables\",\"action\":\"SUM\",\"source\":\"py_gross_revenue_less_unsalables\",\"label\":\"Sum of PY Gross Revenue less Unsalables\"},{\"name\":\"SUM_next_day_pending\",\"action\":\"SUM\",\"source\":\"next_day_pending\",\"label\":\"Sum of Next Day Pending\"}]}},\"AGGREGATE5\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_CY_Objectives\"}]},\"sources\":[\"EXTRACT2\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"district\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_CY_Objectives\",\"action\":\"SUM\",\"source\":\"CY_Objectives\",\"label\":\"Sum of CY Objectives\"}]}},\"JOIN1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"FORMULA12\",\"FORMULA8\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"CurrentDay\"],\"rightQualifier\":\"DayFactor\",\"rightKeys\":[\"Date_formula\"],\"joinType\":\"LOOKUP\"}},\"JOIN0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"AGGREGATE3\",\"AGGREGATE5\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"district\"],\"rightQualifier\":\"Objectives\",\"rightKeys\":[\"district\"],\"joinType\":\"LOOKUP\"}},\"EXTRACT1\":{\"sources\":[\"FILTER0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT2\":{\"sources\":[\"FILTER1\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}}},\"ui\":{\"hiddenColumns\":[],\"connectors\":[{\"source\":\"AGGREGATE2\",\"target\":\"JOIN0\"},{\"source\":\"FILTER0\",\"target\":\"AGGREGATE2\"},{\"source\":\"LOAD_DATASET0\",\"target\":\"FILTER0\"},{\"source\":\"JOIN0\",\"target\":\"TRANSFORM0\"},{\"source\":\"LOAD_DATASET2\",\"target\":\"TRANSFORM1\"},{\"source\":\"TRANSFORM0\",\"target\":\"JOIN1\"},{\"source\":\"TRANSFORM1\",\"target\":\"JOIN1\"},{\"source\":\"JOIN1\",\"target\":\"TRANSFORM2\"},{\"source\":\"FILTER1\",\"target\":\"AGGREGATE4\"},{\"source\":\"LOAD_DATASET1\",\"target\":\"FILTER1\"},{\"source\":\"AGGREGATE4\",\"target\":\"JOIN0\"},{\"source\":\"TRANSFORM2\",\"target\":\"OUTPUT0\"}],\"nodes\":{\"FILTER0\":{\"top\":112,\"left\":252,\"label\":\"Filter 0\",\"type\":\"FILTER\"},\"FILTER1\":{\"top\":252,\"left\":252,\"label\":\"Filter 1\",\"type\":\"FILTER\"},\"AGGREGATE2\":{\"connectors\":[{\"source\":\"EXTRACT1\",\"target\":\"AGGREGATE3\"}],\"top\":112,\"left\":392,\"label\":\"Aggregate 2\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE3\":null,\"EXTRACT1\":null}},\"AGGREGATE4\":{\"connectors\":[{\"source\":\"EXTRACT2\",\"target\":\"AGGREGATE5\"}],\"top\":252,\"left\":392,\"label\":\"Aggregate 4\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE5\":null,\"EXTRACT2\":null}},\"JOIN1\":{\"top\":112,\"left\":812,\"label\":\"Join 1\",\"type\":\"JOIN\"},\"JOIN0\":{\"top\":112,\"left\":532,\"label\":\"Join 0\",\"type\":\"JOIN\"},\"OUTPUT0\":{\"top\":112,\"left\":1092,\"label\":\"Output 0\",\"type\":\"OUTPUT\"},\"LOAD_DATASET2\":{\"top\":252,\"left\":532,\"label\":\"Day Factor\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"LOAD_DATASET1\":{\"top\":252,\"left\":112,\"label\":\"MDLZ Territory Objectives\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"LOAD_DATASET0\":{\"top\":112,\"left\":112,\"label\":\"MDLZ Segment Revenue\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"TRANSFORM0\":{\"connectors\":[{\"source\":\"FORMULA0\",\"target\":\"FORMULA1\"},{\"source\":\"FORMULA1\",\"target\":\"FORMULA2\"},{\"source\":\"FORMULA2\",\"target\":\"FORMULA3\"},{\"source\":\"FORMULA3\",\"target\":\"FORMULA4\"},{\"source\":\"FORMULA4\",\"target\":\"FORMULA5\"},{\"source\":\"FORMULA5\",\"target\":\"FORMULA6\"},{\"source\":\"FORMULA6\",\"target\":\"FORMULA7\"},{\"source\":\"FORMULA7\",\"target\":\"FORMULA12\"}],\"top\":112,\"left\":672,\"label\":\"Transform 0\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA6\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA7\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA1\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA2\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA3\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA4\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA5\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA12\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM1\":{\"connectors\":[],\"top\":252,\"left\":672,\"label\":\"Transform 1\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA8\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM2\":{\"connectors\":[{\"source\":\"FORMULA9\",\"target\":\"FORMULA10\"},{\"source\":\"FORMULA10\",\"target\":\"FORMULA11\"},{\"source\":\"FORMULA13\",\"target\":\"DROP_FIELDS0\"},{\"source\":\"FORMULA11\",\"target\":\"FORMULA13\"}],\"top\":112,\"left\":952,\"label\":\"Transform 2\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA13\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA9\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"DROP_FIELDS0\":{\"label\":\"Drop Columns\"},\"FORMULA10\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA11\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}}},\"assetType\":\"TCRM\"},\"version\":\"55.0\"}"]